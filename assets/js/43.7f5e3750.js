(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{576:function(t,e,a){"use strict";a.r(e);var s=a(18),_=Object(s.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"æ—¥å¿—æäº¤è§„èŒƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ—¥å¿—æäº¤è§„èŒƒ","aria-hidden":"true"}},[t._v("#")]),t._v(" æ—¥å¿—æäº¤è§„èŒƒ")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"Git%E6%97%A5%E5%BF%97%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83"}},[t._v("Gitæ—¥å¿—æäº¤è§„èŒƒ")])])]),t._v(" "),a("h2",{attrs:{id:"git-ignore-è§„èŒƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#git-ignore-è§„èŒƒ","aria-hidden":"true"}},[t._v("#")]),t._v(" Git Ignore è§„èŒƒ")]),t._v(" "),a("p",[t._v("ä¸ºäº†é¿å…å°†ä¸å¿…è¦çš„æ–‡ä»¶æäº¤åˆ°ä»“åº“ä¸­ï¼Œéœ€è¦æˆ‘ä»¬åœ¨æ¯ä¸ªå·¥ç¨‹çš„"),a("code",[t._v("æ ¹ç›®å½•ä¸‹")]),t._v("é‡Œé¢ç¼–å†™æ­£ç¡®çš„"),a("code",[t._v(".gitignore")]),t._v(" æ–‡ä»¶ã€‚")]),t._v(" "),a("p",[t._v("ç”±äºJavaå’Œå‰ç«¯å·¥ç¨‹ç›®å½•ç»“æ„ã€ç¼–è¯‘å†…å®¹ç­‰ä¸ä¸€è‡´çš„åŸå› ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å‰åç«¯çš„ä¸åŒç¼–å†™ä¸åŒçš„"),a("code",[t._v(".gitignore")]),t._v("æ–‡ä»¶ã€‚")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"gitignore-for-java-project"}},[t._v(".gitignore for java project")])]),t._v(" "),a("li",[a("a",{attrs:{href:"gitignore-for-web-project"}},[t._v(".gitignore for web project")])])]),t._v(" "),a("h2",{attrs:{id:"åˆ†æ”¯å¼€å‘æµç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ†æ”¯å¼€å‘æµç¨‹","aria-hidden":"true"}},[t._v("#")]),t._v(" åˆ†æ”¯å¼€å‘æµç¨‹")]),t._v(" "),a("h3",{attrs:{id:"git-flow"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#git-flow","aria-hidden":"true"}},[t._v("#")]),t._v(" Git Flow")]),t._v(" "),a("p",[a("img",{attrs:{src:"/uploads/0d9ee292f61d9d222f277b9dac9f8893/github_flow.png",alt:"github_flow"}})]),t._v(" "),a("p",[a("strong",[t._v("è¯´æ˜")])]),t._v(" "),a("ol",[a("li",[t._v("åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼šå½“ä½ è¦å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½çš„æ—¶å€™ï¼Œä»masteråˆ†æ”¯åˆ›å»ºä¸€ä¸ªç‰¹æ€§åˆ†æ”¯ï¼Œ"),a("code",[t._v("git checkout -b [fixture-branch-name]")])]),t._v(" "),a("li",[t._v("åœ¨æ–°åˆ†æ”¯ä¸Šæäº¤ä»£ç ï¼Œ"),a("a",{attrs:{href:"Git%E6%97%A5%E5%BF%97%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83"}},[t._v("å‚è€ƒGitæäº¤çš„æ—¥å¿—è§„èŒƒ")]),t._v("ï¼Œ"),a("code",[t._v("git add [files]; git commit -m 'commit messages'")])]),t._v(" "),a("li",[t._v("ä¸ä¸»å¹²åŒæ­¥ï¼Œ"),a("code",[t._v("git fetch origin; git rebase origin/master")])]),t._v(" "),a("li",[a("a",{attrs:{href:"%E5%90%88%E5%B9%B6Commit"}},[t._v("åˆå¹¶ commit")]),t._v("ï¼ˆè¯¥æ­¥éª¤å¯é€‰ï¼‰")]),t._v(" "),a("li",[t._v("å°†ä»£ç pushåˆ°è¿œç¨‹ä»“åº“ï¼Œ"),a("code",[t._v("git push")])]),t._v(" "),a("li",[t._v("å¦‚æœè¯¥ç‰¹æ€§åˆ†æ”¯æ‰€æœ‰åŠŸèƒ½å¼€å‘å®Œæˆï¼Œåœ¨ "),a("a",{attrs:{href:"http://git.fpi-inc.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("git.fpi-inc.com"),a("OutboundLink")],1),t._v(" ä¸Šæäº¤ Merge Requestï¼ŒMerge Request çš„ç›®çš„åˆ†æ”¯æ˜¯ master")]),t._v(" "),a("li",[t._v("å¼€å‘è´Ÿè´£äººè¿›è¡Œ"),a("a",{attrs:{href:"#%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%A0%B8"}},[t._v("ä»£ç å®¡æ ¸")]),t._v("ï¼Œå®¡æ ¸é€šè¿‡åæ–¹å¯ä»¥æ‰§è¡Œ"),a("code",[t._v("Merge")]),t._v("æ“ä½œï¼Œå®¡æ ¸æœªé€šè¿‡çš„ï¼Œæäº¤å®¡æ ¸åé¦ˆå†…å®¹")]),t._v(" "),a("li",[a("code",[t._v("Merge")]),t._v("æˆåŠŸååˆ é™¤ç‰¹æ€§åˆ†æ”¯")])]),t._v(" "),a("blockquote",[a("p",[t._v("ä¸ºäº†ä¿æŠ¤masteråˆ†æ”¯ä¸è¢«ç ´åï¼Œéœ€è¦å°† master åˆ†æ”¯è®¾ç½®ä¸ºä¿æŠ¤çš„åˆ†æ”¯ï¼š"),a("code",[t._v("Settings -> Repository -> Protected Branches")])])]),t._v(" "),a("h3",{attrs:{id:"åˆ†æ”¯å‘½åè§„èŒƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ†æ”¯å‘½åè§„èŒƒ","aria-hidden":"true"}},[t._v("#")]),t._v(" åˆ†æ”¯å‘½åè§„èŒƒ")]),t._v(" "),a("blockquote",[a("p",[t._v("åˆ†æ”¯å‘½åé‡‡ç”¨"),a("code",[t._v("[issue-id-][issue-name]")])])]),t._v(" "),a("ul",[a("li",[t._v("issue-idï¼šå¯é€‰ï¼Œè¡¨ç¤º gitlab ä¸­çš„ issue ç¼–å·")]),t._v(" "),a("li",[t._v("issue-nameï¼šä»¥ä¸­åˆ’çº¿è¿æ¥çš„è‹±æ–‡çŸ­è¯­ï¼Œè¡¨ç¤ºè¯¥åˆ†æ”¯å¯¹åº”çš„Featureçš„æ¦‚è¿°ï¼Œå¿…å¡«")])]),t._v(" "),a("p",[t._v("ä¿ç•™çš„åˆ†æ”¯åç§°ï¼Œä¸¥ç¦ä¸ªäººä½¿ç”¨ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("master*")]),t._v(" "),a("li",[t._v("dev*")]),t._v(" "),a("li",[t._v("release*")]),t._v(" "),a("li",[t._v("test*")]),t._v(" "),a("li",[t._v("snapshot*")]),t._v(" "),a("li",[t._v("prod*")]),t._v(" "),a("li",[t._v("production*")]),t._v(" "),a("li",[t._v("tag*")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("*")]),t._v("æ˜¯é€šé…ç¬¦")])]),t._v(" "),a("p",[t._v("ç¤ºä¾‹ï¼š")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("git checkout -b 123-add-user-management-service // æ­£ç¡®\n\ngit checkout -b 'xiongzhijun'  // é”™è¯¯ï¼Œä¸èƒ½ç”¨ä¸ªäººçš„åå­—ä½œä¸ºåˆ†æ”¯\n\ngit checkout -b 'dev' // é”™è¯¯ï¼Œdev æ˜¯ä¿ç•™åˆ†æ”¯åç§°\n")])])]),a("h3",{attrs:{id:"gitå·¥ç¨‹å¼ºåˆ¶è®¾ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitå·¥ç¨‹å¼ºåˆ¶è®¾ç½®","aria-hidden":"true"}},[t._v("#")]),t._v(" Gitå·¥ç¨‹å¼ºåˆ¶è®¾ç½®")]),t._v(" "),a("p",[t._v("1.ä»¥ä¸‹åˆ†æ”¯ï¼Œä¸å…è®¸ç›´æ¥push")]),t._v(" "),a("ul",[a("li",[t._v("master*")]),t._v(" "),a("li",[t._v("dev*")]),t._v(" "),a("li",[t._v("release*")]),t._v(" "),a("li",[t._v("test*")]),t._v(" "),a("li",[t._v("snapshot*")]),t._v(" "),a("li",[t._v("prod*")]),t._v(" "),a("li",[t._v("production*")]),t._v(" "),a("li",[t._v("tag*")]),t._v(" "),a("li",[t._v("milestones*")])]),t._v(" "),a("blockquote",[a("p",[t._v("è®¾ç½®è·¯å¾„ï¼šSettings->Repository->Protected Branches->Allowed to push=No one")])]),t._v(" "),a("blockquote",[a("p",[t._v("åŠ è¿™ä¸€æ¡çš„ç›®çš„æ˜¯ä¸ºäº†æ¨è¡Œï¼šåŸºäºç‰¹æ€§åˆ†æ”¯çš„å¼€å‘æ¨¡å¼ã€ä»¥åŠæ¨è¡Œä»£ç å®¡æŸ¥åˆå¹¶æ¨¡å¼")])]),t._v(" "),a("p",[t._v("2.å¼€å¯ Fast-forward merge")]),t._v(" "),a("p",[t._v("å¼€å¯äº†è¿™æ¡è®¾ç½®ï¼Œå°±ä¸èƒ½å†å‘èµ·mergeè¯·æ±‚ï¼Œæ‰€æœ‰çš„mergeéƒ½æ˜¯fast-forwardçš„ã€‚å¦‚æœä½ çš„åˆ†æ”¯ä¸èƒ½è¿›è¡ŒFast-forward mergeï¼Œå°±è¦è¿›è¡Œrebase")]),t._v(" "),a("blockquote",[a("p",[t._v("è®¾ç½®è·¯å¾„ï¼šSettings->General->Merge request->Merge method->Fast-forward merge")])]),t._v(" "),a("p",[t._v("3.å¼€å¯ Only allow merge requests to be merged if the pipeline succeeds")]),t._v(" "),a("p",[t._v("åªæœ‰pipelineæˆåŠŸçš„æ—¶å€™æ‰å¯ä»¥mergeï¼ˆå¦‚æœæ²¡é…ç½®CIï¼Œè¿™æ¡è®¾ç½®ä¸ç”Ÿæ•ˆï¼‰ã€‚ä½ æœ‰ä¸€ä¸ªåˆ†æ”¯Aï¼Œå¦‚æœAåˆ†æ”¯çš„CIæœªé€šè¿‡ï¼Œåˆ™Aåˆ†æ”¯ä¸èƒ½åˆå¹¶åˆ°masteråˆ†æ”¯ä¸Šã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("è®¾ç½®è·¯å¾„ï¼šSettings->General->Merge request->Merge method->Only allow merge requests to be merged if the pipeline succeeds")])]),t._v(" "),a("p",[t._v("4.å¼€å¯ Only allow merge requests to be merged if all discussions are resolved")]),t._v(" "),a("p",[t._v("åªæœ‰æ‰€æœ‰çš„discussionsè§£å†³äº†æ‰å…è®¸mergeã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("è®¾ç½®è·¯å¾„ï¼šSettings->General->Merge request->Merge method->Only allow merge requests to be merged if all discussions are resolved")])]),t._v(" "),a("h3",{attrs:{id:"ä»£ç å®¡æ ¸"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä»£ç å®¡æ ¸","aria-hidden":"true"}},[t._v("#")]),t._v(" ä»£ç å®¡æ ¸")]),t._v(" "),a("p",[a("strong",[t._v("åŸºäºåˆ†æ”¯çš„ä»£ç  Review")])]),t._v(" "),a("ol",[a("li",[t._v("æ–°å»º Issue (æ— è®ºæ˜¯ bug è¿˜æ˜¯ feature), æè¿°èƒŒæ™¯æˆ–é—®é¢˜,")]),t._v(" "),a("li",[t._v("æœ¬åœ°åˆ›å»ºåˆ†æ”¯ 123-[issue] (123æ˜¯ issue çš„ ID), å›´ç»•å…³è” issue è¿›è¡Œ program -> commit -> push,")]),t._v(" "),a("li",[t._v("æ–°å»º Merge Request ä» 123-[issue] åˆ° master, å¹¶æŒ‡æ´¾ç»™é¡¹ç›® Owner (æˆ–åˆé€‚ Reviewer) ,")]),t._v(" "),a("li",[t._v("è¢«æŒ‡æ´¾äººå®Œæˆä»£ç å®¡æŸ¥åï¼Œ æ‰§è¡Œä»£ç åˆå¹¶, åŒæ—¶åˆ é™¤åˆ†æ”¯ 123-[issue]")]),t._v(" "),a("li",[t._v("å¦‚æœå®¡æŸ¥ä¸é€šè¿‡ï¼Œåˆ™åœ¨æœ‰é—®é¢˜çš„ä»£ç å¤„è¿›è¡Œæ ‡è®°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æäº¤ Comment è¿›è¡Œè®¨è®º")])]),t._v(" "),a("p",[a("strong",[t._v("å¤šäºº Review")])]),t._v(" "),a("ol",[a("li",[t._v("æäº¤ Merge Request åï¼Œ è¢«æŒ‡æ´¾äººå¯é€šè¿‡ @someone é‚€è¯·ä¸€ä¸ªæˆ–å¤šä¸ªé¢å¤–çš„ Reviewer ï¼ˆå®ƒä»¬ä¼šæ”¶åˆ°é‚®ä»¶é€šçŸ¥ï¼‰")]),t._v(" "),a("li",[t._v("è¢«é‚€è¯·çš„ Reviewer çœ‹è¿‡ä»£ç åï¼Œ å¯å›å¤ğŸ‘æˆ–+1è¡¨ç¤ºé€šè¿‡ï¼Œ åä¹‹ç»™å‡ºä¿®æ”¹å»ºè®®ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"é¡¹ç›®å¼€å‘è§„èŒƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é¡¹ç›®å¼€å‘è§„èŒƒ","aria-hidden":"true"}},[t._v("#")]),t._v(" é¡¹ç›®å¼€å‘è§„èŒƒ")]),t._v(" "),a("p",[t._v("å½“æŸä¸ªé¡¹ç›®éœ€è¦ç”¨åˆ°ç°æœ‰äº§å“ï¼ˆæˆ–è€…æŸä¸ªå…¶ä»–å·²ç»äº¤ä»˜çš„é¡¹ç›®ï¼‰æ—¶ï¼Œå¿…é¡»é€šè¿‡ Fork çš„æ–¹å¼åˆ›å»ºæ–°çš„ Repositoryï¼Œè€Œä¸æ˜¯åœ¨è€çš„ Repository ä¸Šåˆ›å»ºåˆ†æ”¯ã€‚")]),t._v(" "),a("h2",{attrs:{id:"æ–‡æ¡£è§„èŒƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ–‡æ¡£è§„èŒƒ","aria-hidden":"true"}},[t._v("#")]),t._v(" æ–‡æ¡£è§„èŒƒ")]),t._v(" "),a("p",[t._v("æ¯ä¸ª Project çš„æŠ€æœ¯æ–‡æ¡£è®°å½•åœ¨è¿™ä¸ª Project å¯¹åº”çš„ Wiki ä¸­ï¼ŒåŒ…æ‹¬ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("ç³»ç»Ÿç›®æ ‡ï¼ˆè§£å†³çš„é—®é¢˜ã€åº”ç”¨åœºæ™¯ç­‰ï¼‰")]),t._v(" "),a("li",[t._v("ç³»ç»Ÿæ¶æ„")]),t._v(" "),a("li",[t._v("æ¦‚è¦è®¾è®¡")]),t._v(" "),a("li",[t._v("æ•°æ®åº“è®¾è®¡")]),t._v(" "),a("li",[t._v("è¯¦ç»†è®¾è®¡")]),t._v(" "),a("li",[t._v("é…ç½®ä¿¡æ¯è¯´æ˜")]),t._v(" "),a("li",[t._v("ç¬¬ä¸‰æ–¹ä½¿ç”¨è¯´æ˜")]),t._v(" "),a("li",[t._v("å¼€å‘ï¼ˆè´¡çŒ®ï¼‰è¯´æ˜")])]),t._v(" "),a("p",[t._v("ç›¸å…³æ–‡æ¡£åº”å½“ä»¥ MarkDown çš„å½¢å¼ç›´æ¥å†™åˆ° Wiki ä¸­ï¼Œé¿å…ç¼–å†™ Word/Excel ç±»å‹çš„æ–‡æ¡£ï¼Œå› ä¸º Wiki æ›´åŠ ç›´è§‚ï¼Œå¯è¯»æ€§å¼ºï¼Œæ–¹ä¾¿åœ¨çº¿ç¼–è¾‘æ›´æ–°ã€‚")]),t._v(" "),a("p",[a("code",[t._v("TODO é¡¹ç›®ç®¡ç†ç›¸å…³æ–‡æ¡£ç­‰åç»­åˆ¶å®šè§„èŒƒ")])]),t._v(" "),a("h2",{attrs:{id:"æŒç»­é›†æˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æŒç»­é›†æˆ","aria-hidden":"true"}},[t._v("#")]),t._v(" æŒç»­é›†æˆ")]),t._v(" "),a("p",[t._v("å‚è€ƒ"),a("a",{attrs:{href:"https://docs.gitlab.com/ce/ci/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gitlab CI"),a("OutboundLink")],1),t._v("å®ç°ã€‚")]),t._v(" "),a("p",[t._v("Gitlab CI ç›¸å¯¹äº Jenkins çš„ä¼˜åŠ¿æ˜¯ï¼šç›¸å…³æŒç»­é›†æˆé…ç½®æ–‡ä»¶ç›´æ¥è·Ÿéš Git Projectï¼Œåœ¨åˆ›å»ºï¼ˆForkï¼‰æ–°çš„é¡¹ç›®åï¼Œé…ç½®æ–‡ä»¶ä¹Ÿç›´æ¥å¸¦ä¸Šäº†ï¼Œåªéœ€è¦å°‘é‡çš„ç¯å¢ƒå˜é‡é…ç½®å°±å¥½äº†ã€‚")]),t._v(" "),a("h3",{attrs:{id:"gitlab-ci-ymlé…ç½®è§„èŒƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab-ci-ymlé…ç½®è§„èŒƒ","aria-hidden":"true"}},[t._v("#")]),t._v(" .gitlab-ci.ymlé…ç½®è§„èŒƒ")]),t._v(" "),a("p",[a("strong",[t._v("1. æ€»ä½“é˜¶æ®µ")])]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("stages")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" pre_build\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" build\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" auto_test\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" push\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" deploy\n")])])]),a("p",[t._v("å…¶ä¸­æ¯ä¸ªé˜¶æ®µéœ€è¦å®Œæˆçš„ä»»åŠ¡å¦‚ä¸‹ï¼š")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("pre_build")]),t._v("é˜¶æ®µéœ€è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªåŠ¨ä½œ\n"),a("ul",[a("li",[a("code",[t._v("é™æ€æ£€æŸ¥")]),t._v(" "),a("ul",[a("li",[t._v("é™¤äº†æ‰“tagè§¦å‘çš„CIä»¥å¤–ï¼Œå…¶å®ƒæ‰€æœ‰è§¦å‘éƒ½è¦æ‰§è¡Œè¯¥åŠ¨ä½œ")])])]),t._v(" "),a("li",[a("code",[t._v("maven site")]),t._v(" "),a("ul",[a("li",[t._v("åªåœ¨masteråˆ†æ”¯è¢«pushæˆ–mergeæ—¶æ‰§è¡Œè¯¥åŠ¨ä½œ")])])]),t._v(" "),a("li",[a("code",[t._v("å•å…ƒæµ‹è¯•")]),t._v(" "),a("ul",[a("li",[t._v("é™¤äº†æ‰“tagè§¦å‘çš„CIä»¥å¤–ï¼Œå…¶å®ƒæ‰€æœ‰è§¦å‘éƒ½è¦æ‰§è¡Œè¯¥åŠ¨ä½œ")])])])])]),t._v(" "),a("li",[a("code",[t._v("build")]),t._v("é˜¶æ®µ\n"),a("ul",[a("li",[t._v("ç¼–è¯‘dockeré•œåƒå¹¶ä¸Šä¼ åˆ°æœ¬åœ°ä»“åº“")]),t._v(" "),a("li",[t._v("éœ€è¦å°†ç‰ˆæœ¬ä¿¡æ¯åŠ å…¥é•œåƒä¸­ï¼Œä¾‹å¦‚javaé¡¹ç›®å¯ä»¥æŠŠåŒ…å«ç‰ˆæœ¬ä¿¡æ¯çš„"),a("code",[t._v("version")]),t._v("æ–‡ä»¶åŠ å…¥waråŒ…ä¸­")]),t._v(" "),a("li",[t._v("ä»…åœ¨masteråˆ†æ”¯æˆ–/^hotfix-.*$/è¢«pushæˆ–mergeæ—¶æ‰§è¡Œè¯¥åŠ¨ä½œ")]),t._v(" "),a("li",[t._v("æ‰“tagæ—¶ä¸æ‰§è¡Œè¯¥åŠ¨ä½œ")])])]),t._v(" "),a("li",[a("code",[t._v("auto_test")]),t._v("é˜¶æ®µ\n"),a("ul",[a("li",[t._v("è‡ªåŠ¨åŒ–æµ‹è¯•")]),t._v(" "),a("li",[t._v("ä»…åœ¨masteråˆ†æ”¯æˆ–/^hotfix-.*$/è¢«pushæˆ–mergeæ—¶æ‰§è¡Œè¯¥åŠ¨ä½œ")]),t._v(" "),a("li",[t._v("æ‰“tagæ—¶ä¸æ‰§è¡Œè¯¥åŠ¨ä½œ")])])]),t._v(" "),a("li",[a("code",[t._v("push")]),t._v("é˜¶æ®µ\n"),a("ul",[a("li",[t._v("å°†dockeré•œåƒæ‰“tag("),a("a",{attrs:{href:"https://git.fpi-inc.com/simple/servers/simple-user-center-server#docker%E9%95%9C%E5%83%8F%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99",target:"_blank",rel:"noopener noreferrer"}},[t._v("æ‰“tagè§„åˆ™"),a("OutboundLink")],1),t._v(")\n"),a("ul",[a("li",[t._v("tagçš„ç»„æˆä¸º "),a("code",[t._v("ä»“åº“å/é•œåƒå:é•œåƒç‰ˆæœ¬")])]),t._v(" "),a("li",[t._v("ä»“åº“åä¸ºæœ¬åœ°æˆ–è¿œç«¯ä»“åº“çš„åŸŸå")]),t._v(" "),a("li",[t._v("é•œåƒåå›ºå®šä¸ºå·¥ç¨‹åï¼š"),a("code",[t._v("$CI_PROJECT_NAME")])]),t._v(" "),a("li",[t._v("tagçš„versionä¸º"),a("code",[t._v("latest")]),t._v("å’Œ"),a("code",[t._v("$CI_COMMIT_TAG")])]),t._v(" "),a("li",[t._v("ç¤ºä¾‹ï¼šéœ€è¦ä¸Šä¼ åˆ°æœ¬åœ°ä»“åº“çš„dockeré•œåƒtagï¼š"),a("code",[t._v("$LOCAL_REPERTORY/$CI_PROJECT_NAME:latest")]),t._v("å’Œ"),a("code",[t._v("$LOCAL_REPERTORY/$CI_PROJECT_NAME:$CI_COMMIT_TAG")])])])]),t._v(" "),a("li",[t._v("å°†æ‰“å¥½tagçš„dockeré•œåƒä¸Šä¼ åˆ°æœ¬åœ°å’Œè¿œç«¯ä»“åº“")]),t._v(" "),a("li",[t._v("åªæœ‰åœ¨æ‰“tag(è¿™ä¸ªtagæŒ‡çš„æ˜¯gitçš„tagè€Œä¸æ˜¯dockerçš„tag)æ—¶æ‰§è¡Œè¯¥åŠ¨ä½œ")])])]),t._v(" "),a("li",[a("code",[t._v("deploy")]),t._v("é˜¶æ®µ\n"),a("ul",[a("li",[t._v("å¼€å‘ç¯å¢ƒéƒ¨ç½²ï¼š\n"),a("ul",[a("li",[t._v("é™¤äº†æ‰“tagè§¦å‘çš„CIä»¥å¤–ï¼Œå…¶å®ƒæ‰€æœ‰è§¦å‘éƒ½è¦æ‰§è¡Œè¯¥åŠ¨ä½œ")]),t._v(" "),a("li",[t._v("éœ€è¦è‡ªåŠ¨æ‰§è¡Œ")]),t._v(" "),a("li",[t._v("éœ€è¦å®šä¹‰"),a("code",[t._v("environment")]),t._v("ä¿¡æ¯")])])]),t._v(" "),a("li",[t._v("æµ‹è¯•ç¯å¢ƒéƒ¨ç½²\n"),a("ul",[a("li",[t._v("ä»…åœ¨masteråˆ†æ”¯æˆ–/^hotfix-.*$/è¢«pushæˆ–mergeæ—¶æ‰§è¡Œè¯¥åŠ¨ä½œ")]),t._v(" "),a("li",[t._v("æ‰“tagæ—¶ä¸æ‰§è¡Œè¯¥åŠ¨ä½œ")]),t._v(" "),a("li",[t._v("éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ")]),t._v(" "),a("li",[t._v("éœ€è¦å®šä¹‰"),a("code",[t._v("environment")]),t._v("ä¿¡æ¯")])])]),t._v(" "),a("li",[t._v("å…¶ä»–ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²\n"),a("ul",[a("li",[t._v("åªæœ‰åœ¨æ‰“tagæ—¶æ‰§è¡Œè¯¥åŠ¨ä½œ")]),t._v(" "),a("li",[t._v("éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ")]),t._v(" "),a("li",[t._v("éœ€è¦å®šä¹‰"),a("code",[t._v("environment")]),t._v("ä¿¡æ¯")])])])])])]),t._v(" "),a("p",[a("strong",[t._v("2. å˜é‡")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("ymlæ–‡ä»¶ä¸­é¢„ç½®çš„å˜é‡å¦‚ä¸‹ï¼Œå…¶å®ƒå·¥ç¨‹å¦‚æœä¸åŒï¼Œå¯ä»¥ç”¨gitlabå·¥ç¨‹ä¸­åˆ›å»ºåŒåå˜é‡è¿›è¡Œè¦†ç›–")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("variables")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("LOCAL_REPERTORY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"docker-lh.fpi-inc.site"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("LOCAL_REPERTORY_USERNAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" admin\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("REMOTE_REPERTORY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"docker.fpi-inc.site"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("REMOTE_REPERTORY_USERNAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" admin\n")])])])]),t._v(" "),a("li",[a("p",[t._v("gitlabå·¥ç¨‹ä¸­çš„é¢„ç½®å˜é‡ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰")]),t._v(" "),a("ul",[a("li",[t._v("SSH_PRIVATE_KEYï¼šç”¨æ¥å…å¯†ç ç™»å½•è¿œç¨‹linuxç³»ç»Ÿ")]),t._v(" "),a("li",[t._v("LOCAL_NEXUS_PASSWDï¼šæœ¬åœ°ä»“åº“ç™»å½•å¯†ç ")]),t._v(" "),a("li",[t._v("REMOTE_REPERTORY_PASSWDï¼šè¿œç¨‹ä»“åº“ç™»å½•å¯†ç ")])])])]),t._v(" "),a("p",[a("strong",[t._v("3. é¢„å¤„ç†")])]),t._v(" "),a("blockquote",[a("p",[t._v("ç”¨æ¥å…å¯†ç™»å½•è¿œç¨‹linuxç³»ç»Ÿ")])]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("before_script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 'which ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("agent "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" ( apt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("get update "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("y && apt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("get install \nopenssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("y )'\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" eval $(ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("agent "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("s)\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v('add <(echo "$SSH_PRIVATE_KEY")\n  '),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" mkdir "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("p ~/.ssh\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" '"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("f /.dockerenv "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" && echo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v('e "Host \n*\\n\\tStrictHostKeyChecking no\\n\\n" '),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" ~/.ssh/config'\n")])])]),a("p",[a("strong",[t._v("5. "),a("code",[t._v(".gitlab-ci.yml")]),a("a",{attrs:{href:"https://git.fpi-inc.com/simple/servers/simple-user-center-server/blob/master/.gitlab-ci.yml",target:"_blank",rel:"noopener noreferrer"}},[t._v("æ–‡ä»¶æ ·ä¾‹"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"å…¶å®ƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…¶å®ƒ","aria-hidden":"true"}},[t._v("#")]),t._v(" å…¶å®ƒ")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"%E5%90%88%E5%B9%B6Commit"}},[t._v("åˆå¹¶ Commit")])])])])},[],!1,null,null,null);e.default=_.exports}}]);